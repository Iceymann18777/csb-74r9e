(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{1231:function(t,n,e){var content=e(1373);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[t.i,content,""]]),content.locals&&(t.exports=content.locals);(0,e(22).default)("7649abd5",content,!0,{sourceMap:!1})},1372:function(t,n,e){"use strict";e(1231)},1373:function(t,n,e){var o=e(21)(!1);o.push([t.i,".container{max-width:450px}.container .price-info{display:grid;grid-auto-rows:auto;grid-row-gap:8px;row-gap:8px;padding:0 12px;font-size:12px;line-height:20px}.container .price-info .anticon-swap{margin-left:10px;padding:5px;border-radius:50%;background:#000829}.container .price-info .price-base{line-height:24px}.container .price-info .fs-container .name{opacity:.75}.container .change-side div{height:32px;width:32px;border-radius:50%;background:#000829;cursor:pointer}.container .fetching-unsettled{margin:12px;display:flex;flex-direction:column;justify-content:center;color:hsla(0,0%,100%,.67843)}.container .fetching-unsettled span{margin-top:16px;text-align:center}.container .settle.card-body{padding:16px 24px}.container .extra{margin-top:32px;margin-bottom:32px}.container .extra .settel-panel .align-right{text-align:right}.container .extra .settel-panel th{font-weight:400}.container .extra .settel-panel td{padding-bottom:4px;width:25%}.container .extra .settel-panel thead{font-size:14px}.container .extra .settel-panel thead tr:first-child{margin-top:8px}.container .extra .settel-panel tbody tr:first-child td{padding-top:6px}",""]),t.exports=o},1420:function(t,n,e){"use strict";e.r(n);e(46),e(52),e(78);var o=e(8),r=e(28),c=(e(619),e(399)),d=e.n(c),progress=(e(1172),e(1173)),l=e.n(progress),m=(e(132),e(72)),h=e.n(m),f=(e(615),e(616)),C=e.n(f),A=(e(196),e(42)),v=e.n(A),k=(e(34),e(146),e(133),e(169),e(148),e(88),e(85),e(121),e(59),e(66),e(26),e(37),e(77),e(621),e(114),e(617),e(9)),S=e(70),w=e(1169),y=e(50),_=e(162),I=e(1),O=e(183),x=e(14),M=e(3),U=e(5),j=e(1190),$=e(12),P=e(105),T=e(99),F=e(64);function B(object,t){var n=Object.keys(object);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(object);t&&(e=e.filter((function(t){return Object.getOwnPropertyDescriptor(object,t).enumerable}))),n.push.apply(n,e)}return n}function W(t){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?B(Object(source),!0).forEach((function(n){Object(r.a)(t,n,source[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(source)):B(Object(source)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(source,n))}))}return t}var L=Object(I.e)("RAY"),z=k.default.extend({components:{Icon:v.a,Tooltip:C.a,Button:h.a,Progress:l.a,Spin:d.a},data:function(){return{TOKENS:I.c,autoRefreshTime:60,countdown:0,marketTimer:null,initialized:!1,loading:!1,swaping:!1,asks:{},bids:{},isFetchingUnsettled:!1,unsettledOpenOrders:null,baseSymbol:"",baseUnsettledAmount:0,isSettlingBase:!1,quoteSymbol:"",quoteUnsettledAmount:0,isSettlingQuote:!1,coinSelectShow:!1,selectFromCoin:!0,fixedFromCoin:!0,fromCoin:L,toCoin:null,fromCoinAmount:"",toCoinAmount:"",toCoinWithSlippage:"",isWrap:!1,market:null,marketAddress:"",lpMintAddress:"",endpoint:"",priceImpact:0,coinBasePrice:!0,outToPirceValue:0,hasPriceSwapped:!1,officialPool:!0,userCheckUnofficial:!1,userCheckUnofficialMint:void 0,userCheckUnofficialShow:!1,findUrlAmmId:!1,ammId:void 0,ammIdSelectShow:!1,ammIdSelectList:[],ammIdSelectOld:!1,ammIdOrMarketSearchShow:!1,userNeedAmmIdOrMarket:void 0,setCoinFromMintLoading:!1,asksAndBidsLoading:!0}},head:{title:"Raydium Swap"},computed:W({},Object(S.e)(["wallet","swap","liquidity","url","setting"])),watch:{fromCoinAmount:function(t,n){var e=this;this.$nextTick((function(){O.b.test(Object(O.a)(t))?e.updateAmounts():e.fromCoinAmount=n}))},"wallet.tokenAccounts":{handler:function(t){this.updateCoinInfo(t),this.findMarket(),this.ammId&&this.needUserCheckUnofficialShow(this.ammId),this.market&&this.fetchUnsettledByMarket()},deep:!0},fromCoin:function(t,n){this.setCoinFromMintLoading||null!==n&&null!==t&&t.mintAddress===n.mintAddress||(this.userNeedAmmIdOrMarket=void 0,this.findMarket(),this.fromCoinAmount="",this.toCoinAmount="",this.ammIdSelectOld=!1)},baseUnsettledAmount:function(){this.isSettlingBase=!1},quoteUnsettledAmount:function(){this.isSettlingQuote=!1},toCoin:function(t,n){this.setCoinFromMintLoading||null!==n&&null!==t&&t.mintAddress===n.mintAddress||(this.userNeedAmmIdOrMarket=void 0,this.findMarket(),this.fromCoinAmount="",this.toCoinAmount="",this.ammIdSelectOld=!1)},market:function(){this.baseSymbol="",this.baseUnsettledAmount=0,this.quoteSymbol="",this.quoteUnsettledAmount=0,this.unsettledOpenOrders=null,this.fetchUnsettledByMarket()},marketAddress:function(){this.updateAmounts()},asks:function(){this.updateAmounts()},bids:function(){this.updateAmounts()},"liquidity.infos":{handler:function(t){this.updateAmounts();var n=this.$route.query,e=n.from,o=n.to,r=n.ammId;this.findUrlAmmId&&this.setCoinFromMint(r,e,o),this.findMarket()},deep:!0},"swap.markets":{handler:function(t){this.findMarket()},deep:!0},"setting.slippage":{handler:function(){this.updateAmounts()},deep:!0}},mounted:function(){this.updateCoinInfo(this.wallet.tokenAccounts),this.setMarketTimer();var t=this.$route.query,n=t.from,e=t.to,o=t.ammId;this.setCoinFromMint(o,n,e)},methods:{gt:$.b,get:w.a,openFromCoinSelect:function(){var t=this;this.selectFromCoin=!0,this.closeAllModal("coinSelectShow"),setTimeout((function(){t.coinSelectShow=!0}),1)},openToCoinSelect:function(){var t=this;this.selectFromCoin=!1,this.closeAllModal("coinSelectShow"),setTimeout((function(){t.coinSelectShow=!0}),1)},onCoinSelect:function(t){var n,e,o=this;if(null!==t)this.selectFromCoin?(this.fromCoin=Object(y.a)(t),(null===(n=this.toCoin)||void 0===n?void 0:n.mintAddress)===t.mintAddress&&(this.toCoin=null,this.changeCoinAmountPosition())):(this.toCoin=Object(y.a)(t),(null===(e=this.fromCoin)||void 0===e?void 0:e.mintAddress)===t.mintAddress&&(this.fromCoin=null,this.changeCoinAmountPosition()));else{if(null!==this.fromCoin){var r=Object.values(I.c).find((function(t){var n;return t.mintAddress===(null===(n=o.fromCoin)||void 0===n?void 0:n.mintAddress)}));null==r&&(this.fromCoin=null)}if(null!==this.toCoin){var c=Object.values(I.c).find((function(t){var n;return t.mintAddress===(null===(n=o.toCoin)||void 0===n?void 0:n.mintAddress)}));null==c&&(this.toCoin=null)}}this.coinSelectShow=!1},setCoinFromMint:function(t,n,e){var o,r,c=this;this.setCoinFromMintLoading=!0;try{this.findUrlAmmId=!this.liquidity.initialized,this.userNeedAmmIdOrMarket=t;var d=Object(T.f)(t,n,e);d&&(n&&(o=d.coin.mintAddress===n?d.coin:d.pc,r=d.coin.mintAddress===o.mintAddress?d.pc:d.coin),e&&(r=d.coin.mintAddress===e?d.coin:d.pc,o=d.coin.mintAddress===r.mintAddress?d.pc:d.coin),n&&e||(o=d.coin,r=d.pc)),(o||r)&&(o&&(o.balance=Object(w.a)(this.wallet.tokenAccounts,"".concat(o.mintAddress,".balance")),this.fromCoin=o),r&&(r.balance=Object(w.a)(this.wallet.tokenAccounts,"".concat(r.mintAddress,".balance")),this.toCoin=r))}catch(t){this.$notify.warning({message:t.message,description:""})}setTimeout((function(){c.setCoinFromMintLoading=!1}),1)},needUserCheckUnofficialShow:function(t){var n=this;if(this.wallet.connected&&!this.officialPool){var e=localStorage.getItem("".concat(this.wallet.address,"--checkAmmId"));if((e?e.split("---"):[]).includes(t))return this.userCheckUnofficial=!0,this.userCheckUnofficialMint=t,void(this.userCheckUnofficialShow=!1);if(this.userCheckUnofficialMint===t)return this.userCheckUnofficial=!0,void(this.userCheckUnofficialShow=!1);this.userCheckUnofficial=!1,this.closeAllModal("userCheckUnofficialShow"),setTimeout((function(){n.userCheckUnofficialShow=!0}),1)}},onAmmIdSelect:function(t){this.ammIdSelectShow=!1,t?(this.lpMintAddress=t.lp.mintAddress,this.ammId=t.ammId,this.userNeedAmmIdOrMarket=this.ammId,this.officialPool=t.official,this.findMarket()):(this.ammIdSelectOld=!0,this.findMarket())},onAmmIdOrMarketInput:function(t){this.ammIdOrMarketSearchShow=!1,this.setCoinFromMint(t,void 0,void 0),this.findMarket()},onUserCheckUnofficialSelect:function(t,n){if(this.userCheckUnofficialShow=!1,t){if(this.userCheckUnofficial=!0,this.userCheckUnofficialMint=this.ammId,n){var e=localStorage.getItem("".concat(this.wallet.address,"--checkAmmId"));e?localStorage.setItem("".concat(this.wallet.address,"--checkAmmId"),e+"---".concat(this.ammId)):localStorage.setItem("".concat(this.wallet.address,"--checkAmmId"),"".concat(this.ammId))}}else this.fromCoin=null,this.toCoin=null,this.ammId=void 0,this.officialPool=!0},changeCoinPosition:function(){var t=this;this.setCoinFromMintLoading=!0;var n=this.fromCoin,e=this.toCoin;setTimeout((function(){t.setCoinFromMintLoading=!1}),1),this.fromCoin=e,this.toCoin=n,this.changeCoinAmountPosition()},changeCoinAmountPosition:function(){var t=this.fromCoinAmount,n=this.toCoinAmount;this.fromCoinAmount=n,this.toCoinAmount=t},updateCoinInfo:function(t){if(this.fromCoin){var n=t[this.fromCoin.mintAddress];n&&(this.fromCoin=W(W({},this.fromCoin),n))}if(this.toCoin){var e=t[this.toCoin.mintAddress];e&&(this.toCoin=W(W({},this.toCoin),e))}},findMarket:function(){var t=this;if(this.fromCoin&&this.toCoin&&this.liquidity.initialized){var n=this.userNeedAmmIdOrMarket;if(Object(T.e)(this.fromCoin.mintAddress,this.toCoin.mintAddress))return this.isWrap=!0,this.initialized=!0,this.officialPool=!0,void(this.ammId=void 0);for(var e="",o=0,r=Object.keys(this.swap.markets);o<r.length;o++){var address=r[o];if(Object(F.g)(address)){var c=Object(y.a)(this.swap.markets[address]),d=this.fromCoin.mintAddress,l=this.toCoin.mintAddress;d===I.b.mintAddress&&(d=I.c.WSOL.mintAddress),l===I.b.mintAddress&&(l=I.c.WSOL.mintAddress),(c.baseMint.toBase58()===d&&c.quoteMint.toBase58()===l||c.baseMint.toBase58()===l&&c.quoteMint.toBase58()===d)&&(e=address)}}if(this.fromCoin.mintAddress&&this.toCoin.mintAddress){var m,h,f=Object(F.f)(this.fromCoin.mintAddress===I.c.WSOL.mintAddress?I.b.mintAddress:this.fromCoin.mintAddress,this.toCoin.mintAddress===I.c.WSOL.mintAddress?I.b.mintAddress:this.toCoin.mintAddress,"string"==typeof n?n:void 0),C=Object(F.d)(this.fromCoin.mintAddress===I.c.WSOL.mintAddress?I.b.mintAddress:this.fromCoin.mintAddress,this.toCoin.mintAddress===I.c.WSOL.mintAddress?I.b.mintAddress:this.toCoin.mintAddress,"string"==typeof n?n:void 0,[3]),A=!0;if(1===f.length&&!f[0].official&&C.length>0)console.log("v3");else if(1===f.length&&f[0].official)m=f[0].lp.mintAddress,h=f[0].ammId,A=f[0].official,this.userCheckUnofficialMint=void 0,e=f[0].serumMarket;else if(""===e||void 0!==n&&n!==e){if(1===f.length&&n)h=f[0].ammId,m=f[0].lp.mintAddress,A=f[0].official,e=f[0].serumMarket;else if(f.length>0&&this.ammIdSelectOld)console.log("last user select none");else if(f.length>0)return this.coinSelectShow=!1,void setTimeout((function(){t.ammIdSelectShow=!0,t.ammIdSelectList=Object.values(t.liquidity.infos).filter((function(t){return f.find((function(n){return n.ammId===t.ammId}))}))}),1)}else console.log("official market");this.lpMintAddress=null!=m?m:"",this.initialized=!0,this.ammId=h,this.officialPool=A,h!==this.userCheckUnofficialMint&&(this.userCheckUnofficialMint=void 0),h&&this.needUserCheckUnofficialShow(h)}e?this.marketAddress!==e&&(this.marketAddress=e,this.lpMintAddress="",this.isWrap=!1,_.Market.load(this.$web3,new M.PublicKey(e),{},new M.PublicKey(U.l)).then((function(n){t.market=n,t.getOrderBooks()}))):(this.endpoint="",this.marketAddress="",this.market=null,this.lpMintAddress="",this.isWrap=!1),this.updateUrl()}else this.ammId=void 0,this.endpoint="",this.marketAddress="",this.market=null,this.lpMintAddress="",this.isWrap=!1},getOrderBooks:function(){var t=this;this.loading=!0,this.asksAndBidsLoading=!0,this.countdown=this.autoRefreshTime;var n=this.$web3;if(this.marketAddress&&Object(w.a)(this.swap.markets,this.marketAddress)){var e=Object(w.a)(this.swap.markets,this.marketAddress),o=e.bids,r=e.asks;Object(x.l)(n,[o,r],x.a).then((function(n){n.forEach((function(n){var data=n.account.data,o=_.Orderbook.decode(e,data),r=o.isBids,c=o.slab;r?t.bids=c:t.asks=c,t.asksAndBidsLoading=!1}))})).finally((function(){t.initialized=!0,t.loading=!1,t.countdown=0}))}else this.loading=!1},updateAmounts:function(){var t=this,n="",e=null,o=0,r=0,c="";if(this.fromCoin&&this.toCoin&&this.isWrap&&this.fromCoinAmount)this.toCoinAmount=this.fromCoinAmount;else{if(this.fromCoin&&this.toCoin&&this.ammId&&this.fromCoinAmount){var d=Object.values(this.$accessor.liquidity.infos).find((function(p){return p.ammId===t.ammId})),l=Object(j.d)(d,this.fromCoin.mintAddress,this.toCoin.mintAddress,this.fromCoinAmount,this.setting.slippage),m=l.amountOut,h=l.amountOutWithSlippage,f=l.priceImpact;m.isNullOrZero()||(console.log("input: ".concat(this.fromCoinAmount," raydium out: ").concat(h.fixed())),n=m.fixed(),e=h,o=+new $.a(parseFloat(n)/parseFloat(this.fromCoinAmount),this.toCoin.decimals,!1).fixed(),r=f,c="Raydium Pool")}if(this.fromCoin&&this.toCoin&&this.marketAddress&&this.market&&this.asks&&this.bids&&this.fromCoinAmount&&!this.asksAndBidsLoading){var C=Object(j.c)(this.market,this.asks,this.bids,this.fromCoin.mintAddress,this.toCoin.mintAddress,this.fromCoinAmount,this.setting.slippage),A=C.amountOut,v=C.amountOutWithSlippage,k=C.priceImpact,S=new $.a(A,this.toCoin.decimals,!1),w=new $.a(v,this.toCoin.decimals,!1);S.isNullOrZero()||(console.log("input: ".concat(this.fromCoinAmount,"   serum out: ").concat(w.fixed())),e&&!e.wei.isLessThan(w.wei)||(n=S.fixed(),e=w,o=+new $.a(parseFloat(n)/parseFloat(this.fromCoinAmount),this.toCoin.decimals,!1).fixed(),r=k,c="serum DEX"))}e?(this.toCoinAmount=n,this.toCoinWithSlippage=e.fixed(),this.outToPirceValue=o,this.priceImpact=r,this.endpoint=c):(this.toCoinAmount="",this.toCoinWithSlippage="",this.outToPirceValue=0,this.priceImpact=0,this.endpoint="")}},setMarketTimer:function(){var t=this;this.marketTimer=setInterval((function(){t.loading||t.countdown<t.autoRefreshTime&&(t.countdown+=1,t.countdown===t.autoRefreshTime&&t.getOrderBooks())}),1e3)},placeOrder:function(){var t=this;this.swaping=!0;var n=Object(P.a)().toString();if(this.$notify.info({key:n,message:"Making transaction...",description:"",duration:0}),this.isWrap)Object(j.i)(this.$axios,this.$web3,this.$wallet,this.fromCoin.mintAddress,this.toCoin.mintAddress,Object(w.a)(this.wallet.tokenAccounts,"".concat(this.fromCoin.mintAddress,".tokenAccountAddress")),Object(w.a)(this.wallet.tokenAccounts,"".concat(this.toCoin.mintAddress,".tokenAccountAddress")),this.fromCoinAmount).then((function(e){var o,r;t.$notify.info({key:n,message:"Transaction has been sent",description:function(n){return n("div",["Confirmation is in progress.  Check your transaction on ",n("a",{attrs:{href:"".concat(t.url.explorer,"/tx/").concat(e),target:"_blank"}},"here")])}});var c="Unwrap ".concat(t.fromCoinAmount," ").concat(null===(o=t.fromCoin)||void 0===o?void 0:o.symbol," to ").concat(t.toCoinAmount," ").concat(null===(r=t.toCoin)||void 0===r?void 0:r.symbol);t.$accessor.transaction.sub({txid:e,description:c})})).catch((function(e){t.$notify.error({key:n,message:"Swap failed",description:e.message})})).finally((function(){t.swaping=!1}));else if("Raydium Pool"===this.endpoint&&this.ammId){var e=Object.values(this.$accessor.liquidity.infos).find((function(p){return p.ammId===t.ammId}));Object(j.g)(this.$web3,this.$wallet,e,this.fromCoin.mintAddress,this.toCoin.mintAddress,Object(w.a)(this.wallet.tokenAccounts,"".concat(this.fromCoin.mintAddress,".tokenAccountAddress")),Object(w.a)(this.wallet.tokenAccounts,"".concat(this.toCoin.mintAddress,".tokenAccountAddress")),this.fromCoinAmount,this.toCoinWithSlippage).then((function(e){var o,r;t.$notify.info({key:n,message:"Transaction has been sent",description:function(n){return n("div",["Confirmation is in progress.  Check your transaction on ",n("a",{attrs:{href:"".concat(t.url.explorer,"/tx/").concat(e),target:"_blank"}},"here")])}});var c="Swap ".concat(t.fromCoinAmount," ").concat(null===(o=t.fromCoin)||void 0===o?void 0:o.symbol," to ").concat(t.toCoinAmount," ").concat(null===(r=t.toCoin)||void 0===r?void 0:r.symbol);t.$accessor.transaction.sub({txid:e,description:c})})).catch((function(e){t.$notify.error({key:n,message:"Swap failed",description:e.message})})).finally((function(){t.swaping=!1}))}else Object(j.e)(this.$web3,this.$wallet,this.market,this.asks,this.bids,this.fromCoin.mintAddress,this.toCoin.mintAddress,Object(w.a)(this.wallet.tokenAccounts,"".concat(this.fromCoin.mintAddress,".tokenAccountAddress")),Object(w.a)(this.wallet.tokenAccounts,"".concat(this.toCoin.mintAddress,".tokenAccountAddress")),this.fromCoinAmount,this.setting.slippage).then((function(e){var o,r;t.$notify.info({key:n,message:"Transaction has been sent",description:function(n){return n("div",["Confirmation is in progress.  Check your transaction on ",n("a",{attrs:{href:"".concat(t.url.explorer,"/tx/").concat(e),target:"_blank"}},"here")])}});var c="Swap ".concat(t.fromCoinAmount," ").concat(null===(o=t.fromCoin)||void 0===o?void 0:o.symbol," to ").concat(t.toCoinAmount," ").concat(null===(r=t.toCoin)||void 0===r?void 0:r.symbol);t.$accessor.transaction.sub({txid:e,description:c})})).catch((function(e){t.$notify.error({key:n,message:"Swap failed",description:e.message})})).finally((function(){t.swaping=!1}))},updateUrl:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var e,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("/swap/"===t.$route.path){n.next=2;break}return n.abrupt("return");case 2:if(e=t.$route.query,o=e.from,r=e.to,!t.ammId){n.next=8;break}return n.next=6,t.$router.push({path:"/swap/",query:{ammId:t.ammId}});case 6:n.next=17;break;case 8:if(!t.fromCoin||!t.toCoin){n.next=14;break}if(t.fromCoin.mintAddress===o&&t.toCoin.mintAddress===r){n.next=12;break}return n.next=12,t.$router.push({path:"/swap/",query:{from:t.fromCoin.mintAddress,to:t.toCoin.mintAddress}});case 12:n.next=17;break;case 14:if(t.$route.query&&0===Object.keys(t.$route.query).length){n.next=17;break}return n.next=17,t.$router.push({path:"/swap/"});case 17:case"end":return n.stop()}}),n)})))()},closeAllModal:function(t){"coinSelectShow"!==t&&(this.coinSelectShow=!1),"ammIdSelectShow"!==t&&(this.ammIdSelectShow=!1),"userCheckUnofficialShow"!==t&&(this.userCheckUnofficialShow=!1),"ammIdOrMarketSearchShow"!==t&&(this.ammIdOrMarketSearchShow=!1)},fetchUnsettledByMarket:function(){var t=this;return Object(o.a)(regeneratorRuntime.mark((function n(){var e,o,r;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!t.isFetchingUnsettled){n.next=2;break}return n.abrupt("return");case 2:if(t.$web3&&t.$wallet&&t.market){n.next=4;break}return n.abrupt("return");case 4:return t.isFetchingUnsettled=!0,n.prev=5,n.next=8,Object(j.a)(t.$web3,t.$wallet,t.market);case 8:if(r=n.sent){n.next=11;break}throw new Error("not enough data");case 11:t.baseSymbol=null!==(e=r.baseSymbol)&&void 0!==e?e:"",t.baseUnsettledAmount=r.baseUnsettledAmount,t.quoteSymbol=null!==(o=r.quoteSymbol)&&void 0!==o?o:"",t.quoteUnsettledAmount=r.quoteUnsettledAmount,t.unsettledOpenOrders=r.openOrders,n.next=20;break;case 18:n.prev=18,n.t0=n.catch(5);case 20:return n.prev=20,t.isFetchingUnsettled=!1,n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[5,18,20,23]])})))()},settleFunds:function(t){var n=this,e=Object(P.a)().toString();this.$notify.info({key:e,message:"Making transaction...",description:"",duration:0});var o=this.market.baseMintAddress.toBase58(),r=this.market.quoteMintAddress.toBase58(),c=Object(w.a)(this.wallet.tokenAccounts,"".concat(o,".tokenAccountAddress")),d=Object(w.a)(this.wallet.tokenAccounts,"".concat(r,".tokenAccountAddress"));if("quote"===t){var l=[d,c];c=l[0],d=l[1];var m=[r,o];o=m[0],r=m[1]}"quote"===t?this.isSettlingQuote=!0:this.isSettlingBase=!0,Object(j.f)(this.$web3,this.market,this.unsettledOpenOrders,this.$wallet,o,r,c,d).then((function(t){n.$notify.info({key:e,message:"Transaction has been sent",description:function(e){return e("div",["Confirmation is in progress.  Check your transaction on ",e("a",{attrs:{href:"".concat(n.url.explorer,"/tx/").concat(t),target:"_blank"}},"here")])}});n.$accessor.transaction.sub({txid:t,description:"Settle"})})).then((function(){n.fetchUnsettledByMarket()})).catch((function(t){n.$notify.error({key:e,message:"Settle failed",description:t.message}),n.isSettlingQuote=!1,n.isSettlingBase=!1}))},createAssociatedTokenAccount:function(symbol,t){var n=this;this.swaping=!0;var e=Object(P.a)().toString();this.$notify.info({key:e,message:"Making transaction...",description:"",duration:0});var o="Create ".concat(symbol," token account");Object(x.f)(this.$web3,this.$wallet,t).then((function(t){n.$notify.info({key:e,message:"Transaction has been sent",description:function(e){return e("div",["Confirmation is in progress.  Check your transaction on ",e("a",{attrs:{href:"".concat(n.url.explorer,"/tx/").concat(t),target:"_blank"}},"here")])}}),n.$accessor.transaction.sub({txid:t,description:o})})).catch((function(t){n.$notify.error({key:e,message:"Swap failed",description:t.message})})).finally((function(){n.swaping=!1}))}}}),E=(e(1372),e(19)),component=Object(E.a)(z,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"container"},[e("div",{staticClass:"page-head fs-container"},[e("span",{staticClass:"title"},[t._v("Swap")]),t._v(" "),e("div",{staticClass:"buttons"},[e("Tooltip",{attrs:{placement:"bottomRight"}},[e("template",{slot:"title"},[e("span",[t._v("\n            Displayed data will auto-refresh after\n            "+t._s(t.autoRefreshTime-t.countdown)+" seconds. Click this circle to update manually.\n          ")])]),t._v(" "),e("Progress",{class:t.marketAddress&&t.loading?"disabled":"",attrs:{type:"circle",width:20,"stroke-width":10,percent:100/t.autoRefreshTime*t.countdown,"show-info":!1},on:{click:t.getOrderBooks}})],2),t._v(" "),e("Tooltip",{attrs:{placement:"bottomRight"}},[e("template",{slot:"title"},[e("p",[t._v("Addresses")]),t._v(" "),e("div",{staticClass:"swap-info"},[t.fromCoin?e("div",{staticClass:"info"},[e("div",{staticClass:"symbol"},[t._v(t._s(t.fromCoin.symbol))]),t._v(" "),e("div",{staticClass:"address"},[t._v("\n                "+t._s(t.fromCoin.mintAddress.substr(0,14))+"\n                ...\n                "+t._s(t.fromCoin.mintAddress.substr(t.fromCoin.mintAddress.length-14,14))+"\n              ")]),t._v(" "),e("div",{staticClass:"action"},[e("Icon",{attrs:{type:"copy"},on:{click:function(n){return t.$accessor.copy(t.fromCoin.mintAddress)}}}),t._v(" "),e("a",{attrs:{href:t.url.explorer+"/token/"+t.fromCoin.mintAddress,target:"_blank"}},[e("Icon",{attrs:{type:"link"}})],1)],1)]):t._e(),t._v(" "),t.toCoin?e("div",{staticClass:"info"},[e("div",{staticClass:"symbol"},[t._v(t._s(t.toCoin.symbol))]),t._v(" "),e("div",{staticClass:"address"},[t._v("\n                "+t._s(t.toCoin.mintAddress.substr(0,14))+"\n                ...\n                "+t._s(t.toCoin.mintAddress.substr(t.toCoin.mintAddress.length-14,14))+"\n              ")]),t._v(" "),e("div",{staticClass:"action"},[e("Icon",{attrs:{type:"copy"},on:{click:function(n){return t.$accessor.copy(t.toCoin.mintAddress)}}}),t._v(" "),e("a",{attrs:{href:t.url.explorer+"/token/"+t.toCoin.mintAddress,target:"_blank"}},[e("Icon",{attrs:{type:"link"}})],1)],1)]):t._e(),t._v(" "),t.marketAddress?e("div",{staticClass:"info"},[e("div",{staticClass:"symbol"},[t._v("Market")]),t._v(" "),e("div",{staticClass:"address"},[t._v("\n                "+t._s(t.marketAddress.substr(0,14))+"\n                ...\n                "+t._s(t.marketAddress.substr(t.marketAddress.length-14,14))+"\n              ")]),t._v(" "),e("div",{staticClass:"action"},[e("Icon",{attrs:{type:"copy"},on:{click:function(n){return t.$accessor.copy(t.marketAddress)}}}),t._v(" "),t.officialPool?e("a",{attrs:{href:t.url.trade+"/"+t.marketAddress,target:"_blank"}},[e("Icon",{attrs:{type:"link"}})],1):e("a",{attrs:{href:t.url.explorer+"/account/"+t.marketAddress,target:"_blank"}},[e("Icon",{attrs:{type:"link"}})],1)],1)]):t._e(),t._v(" "),t.ammId?e("div",{staticClass:"info"},[e("div",{staticClass:"symbol"},[t._v("AMM ID")]),t._v(" "),e("div",{staticClass:"address"},[t._v("\n                "+t._s(t.ammId?t.ammId.substr(0,14):"")+"\n                ...\n                "+t._s(t.ammId?t.ammId.substr(t.ammId.length-14,14):"")+"\n              ")]),t._v(" "),e("div",{staticClass:"action"},[e("Icon",{attrs:{type:"copy"},on:{click:function(n){return t.$accessor.copy(t.ammId)}}}),t._v(" "),e("a",{attrs:{href:t.url.explorer+"/account/"+t.ammId,target:"_blank"}},[e("Icon",{attrs:{type:"link"}})],1)],1)]):t._e()])]),t._v(" "),e("Icon",{attrs:{type:"info-circle"}})],2),t._v(" "),e("Icon",{attrs:{type:"setting"},on:{click:t.$accessor.setting.open}}),t._v(" "),e("Tooltip",{attrs:{placement:"bottomRight"}},[e("template",{slot:"title"},[t._v(" Search for a pool ")]),t._v(" "),e("Icon",{attrs:{type:"search"},on:{click:function(n){t.ammIdOrMarketSearchShow=!0}}})],2)],1)]),t._v(" "),t.coinSelectShow?e("CoinSelect",{on:{onClose:function(){return t.coinSelectShow=!1},onSelect:t.onCoinSelect}}):t._e(),t._v(" "),e("AmmIdSelect",{attrs:{show:t.ammIdSelectShow,"liquidity-list":t.ammIdSelectList,"user-close":!0},on:{onClose:function(){return t.ammIdSelectShow=!1,t.ammIdSelectOld=!0},onSelect:t.onAmmIdSelect}}),t._v(" "),t.userCheckUnofficialShow?e("UnofficialPoolConfirmUser",{on:{onClose:function(){return t.userCheckUnofficialShow=!1},onSelect:t.onUserCheckUnofficialSelect}}):t._e(),t._v(" "),t.ammIdOrMarketSearchShow?e("InputAmmIdOrMarket",{on:{onClose:function(){return t.ammIdOrMarketSearchShow=!1},onInput:t.onAmmIdOrMarketInput}}):t._e(),t._v(" "),e("div",{staticClass:"card"},[e("div",{staticClass:"card-body"},[e("CoinInput",{attrs:{label:"From","mint-address":t.fromCoin?t.fromCoin.mintAddress:"","coin-name":t.fromCoin?t.fromCoin.symbol:"",balance:t.fromCoin?t.fromCoin.balance:null},on:{onInput:function(n){return t.fromCoinAmount=n},onFocus:function(){t.fixedFromCoin=!0},onMax:function(){t.fixedFromCoin=!0,t.fromCoinAmount=t.fromCoin&&t.fromCoin.balance?t.fromCoin.balance.fixed():"0"},onSelect:t.openFromCoinSelect},model:{value:t.fromCoinAmount,callback:function(n){t.fromCoinAmount=n},expression:"fromCoinAmount"}}),t._v(" "),e("div",{staticClass:"change-side fc-container"},[e("div",{staticClass:"fc-container",on:{click:t.changeCoinPosition}},[e("Icon",{attrs:{type:"swap",rotate:90}})],1)]),t._v(" "),e("CoinInput",{attrs:{label:"To (Estimate)","mint-address":t.toCoin?t.toCoin.mintAddress:"","coin-name":t.toCoin?t.toCoin.symbol:"",balance:t.toCoin?t.toCoin.balance:null,"show-max":!1,disabled:!0},on:{onInput:function(n){return t.toCoinAmount=n},onFocus:function(){t.fixedFromCoin=!1},onMax:function(){t.fixedFromCoin=!1,t.toCoinAmount=t.toCoin.balance.fixed()},onSelect:t.openToCoinSelect},model:{value:t.toCoinAmount,callback:function(n){t.toCoinAmount=n},expression:"toCoinAmount"}}),t._v(" "),e("div",{staticClass:"price-info",staticStyle:{padding:"0 12px"}},[t.fromCoin&&t.toCoin&&t.isWrap&&t.fromCoinAmount?e("div",{staticClass:"price-base fc-container"},[e("span",[t._v("\n            1 "+t._s(t.fromCoin.symbol)+" = 1\n            "+t._s(t.toCoin.symbol)+"\n          ")])]):t.fromCoin&&t.toCoin&&t.lpMintAddress&&t.fromCoinAmount||t.fromCoin&&t.toCoin&&t.marketAddress&&t.market&&t.asks&&t.bids&&t.fromCoinAmount?e("div",{staticClass:"price-base fc-container"},[e("span",[t._v("\n            1 "+t._s(t.hasPriceSwapped?t.toCoin.symbol:t.fromCoin.symbol)+" ≈\n            "+t._s(t.hasPriceSwapped?(1/t.outToPirceValue).toFixed(6):t.outToPirceValue)+"\n            "+t._s(t.hasPriceSwapped?t.fromCoin.symbol:t.toCoin.symbol)+"\n            "),e("Icon",{attrs:{type:"swap"},on:{click:function(){return t.hasPriceSwapped=!t.hasPriceSwapped}}})],1)]):t._e(),t._v(" "),e("div",{staticClass:"fs-container"},[e("span",{staticClass:"name"},[t._v(" Slippage Tolerance ")]),t._v(" "),e("span",[t._v(" "+t._s(t.$accessor.setting.slippage)+"% ")])]),t._v(" "),t.endpoint?e("div",{staticClass:"fs-container"},[e("span",{staticClass:"name"},[t._v(" Swapping Through")]),t._v(" "),e("span",{staticStyle:{"text-transform":"capitalize"}},[t._v(" "+t._s(t.endpoint)+" ")])]):t._e(),t._v(" "),t.fromCoin&&t.toCoin&&t.fromCoinAmount&&t.toCoinWithSlippage?e("div",{staticClass:"fs-container"},[e("span",{staticClass:"name"},[t._v(" Minimum Received ")]),t._v(" "),e("span",[t._v(" "+t._s(t.toCoinWithSlippage)+" "+t._s(t.toCoin.symbol)+" ")])]):t._e(),t._v(" "),t.endpoint?e("div",{staticClass:"fs-container"},[e("span",{staticClass:"name"},[t._v(" Price Impact ")]),t._v(" "),e("span",{style:"color: "+(t.priceImpact>10?"#ed4b9e":t.priceImpact>5?"#f0b90b":"#31d0aa")},[t._v("\n            "+t._s(t.priceImpact.toFixed(2))+"%\n          ")])]):t._e()]),t._v(" "),!1===t.officialPool?e("div",[e("div",{staticStyle:{margin:"10px"}},[e("div",[t._v("AMM ID:")]),t._v(" "),e("div",[t._v("\n            "+t._s(t.ammId?t.ammId.substr(0,14):"")+"\n            ...\n            "+t._s(t.ammId?t.ammId.substr(t.ammId.length-14,14):"")+"\n          ")])])]):t._e(),t._v(" "),t.wallet.connected?t.officialPool||!t.officialPool&&t.userCheckUnofficial?t.initialized&&t.fromCoin&&!t.get(t.wallet.tokenAccounts,t.fromCoin.mintAddress)?e("Button",{attrs:{size:"large",ghost:""},on:{click:function(n){return t.createAssociatedTokenAccount(t.fromCoin.symbol,t.fromCoin.mintAddress)}}},[t._v("\n        Create "+t._s(t.fromCoin.symbol)+" account\n      ")]):t.initialized&&t.toCoin&&!t.get(t.wallet.tokenAccounts,t.toCoin.mintAddress)?e("Button",{attrs:{size:"large",ghost:""},on:{click:function(n){return t.createAssociatedTokenAccount(t.toCoin.symbol,t.toCoin.mintAddress)}}},[t._v("\n        Create "+t._s(t.toCoin.symbol)+" account\n      ")]):e("Button",{attrs:{size:"large",ghost:"",disabled:!t.fromCoin||!t.fromCoinAmount||!t.toCoin||!t.marketAddress&&!t.lpMintAddress&&!t.isWrap||!t.initialized||t.loading||t.gt(t.fromCoinAmount,t.fromCoin&&t.fromCoin.balance?t.fromCoin.balance.fixed():"0")||t.get(t.liquidity.infos,t.lpMintAddress+".status")&&1!==t.get(t.liquidity.infos,t.lpMintAddress+".status")||t.swaping||t.fromCoin.mintAddress===t.TOKENS.xCOPE.mintAddress&&t.gt(5,t.fromCoinAmount)||t.toCoin.mintAddress===t.TOKENS.xCOPE.mintAddress&&t.gt(5,t.toCoinAmount),loading:t.swaping},on:{click:t.placeOrder}},[t.fromCoin&&t.toCoin?(t.marketAddress||t.lpMintAddress||t.isWrap)&&t.initialized?t.fromCoinAmount?t.loading?[t._v(" Updating price information ")]:t.gt(t.fromCoinAmount,t.fromCoin&&t.fromCoin.balance?t.fromCoin.balance.fixed():"0")?[t._v("\n          Insufficient "+t._s(t.fromCoin.symbol)+" balance\n        ")]:t.get(t.liquidity.infos,t.lpMintAddress+".status")&&1!==t.get(t.liquidity.infos,t.lpMintAddress+".status")?[t._v("\n          Pool coming soon\n        ")]:t.fromCoin.mintAddress===t.TOKENS.xCOPE.mintAddress&&t.gt(5,t.fromCoinAmount)||t.toCoin.mintAddress===t.TOKENS.xCOPE.mintAddress&&t.gt(5,t.toCoinAmount)?[t._v("\n          xCOPE amount must greater than 5\n        ")]:[t._v(t._s(t.isWrap?"Unwrap":"Swap"))]:[t._v(" Enter an amount ")]:[t._v("\n          Insufficient liquidity for this trade\n        ")]:[t._v(" Select a token ")]],2):e("Button",{attrs:{size:"large",ghost:""},on:{click:function(){t.setTimeout((function(){t.userCheckUnofficialShow=!0}),1)}}},[t._v("\n        Confirm Risk Warning\n      ")]):e("Button",{attrs:{size:"large",ghost:""},on:{click:t.$accessor.wallet.openModal}},[t._v("\n        Connect Wallet\n      ")])],1)]),t._v(" "),!t.baseSymbol&&!t.quoteSymbol&&t.isFetchingUnsettled||t.baseUnsettledAmount||t.quoteUnsettledAmount?e("div",{staticClass:"card extra"},[e("div",{staticClass:"settle card-body"},[t.baseSymbol||t.quoteSymbol||!t.isFetchingUnsettled?t.baseSymbol&&t.quoteSymbol&&!t.isFetchingUnsettled&&t.baseUnsettledAmount||t.quoteUnsettledAmount?e("table",{staticClass:"settel-panel"},[t._m(0),t._v(" "),e("tbody",[t.baseSymbol&&t.baseUnsettledAmount?e("tr",{staticClass:"row"},[e("td",[t._v(t._s(t.baseSymbol))]),t._v(" "),e("td",[t._v(t._s(t.baseUnsettledAmount))]),t._v(" "),e("td",{staticClass:"align-right",attrs:{rowspan:"2"}},[e("Button",{staticClass:"btn",attrs:{loading:t.isSettlingBase,ghost:""},on:{click:function(n){return t.settleFunds("base")}}},[t._v("Settle")])],1)]):t._e(),t._v(" "),t.quoteSymbol&&t.quoteUnsettledAmount?e("tr",{staticClass:"row"},[e("td",[t._v(t._s(t.quoteSymbol))]),t._v(" "),e("td",[t._v(t._s(t.quoteUnsettledAmount))]),t._v(" "),t.baseUnsettledAmount?t._e():e("td",{staticClass:"align-right",attrs:{rowspan:"2"}},[e("Button",{staticClass:"btn",attrs:{loading:t.isSettlingBase,ghost:""},on:{click:function(n){return t.settleFunds("base")}}},[t._v("Settle")])],1)]):t._e()])]):t._e():e("div",{staticClass:"fetching-unsettled"},[e("Spin",{attrs:{spinning:!0}},[e("Icon",{staticStyle:{"font-size":"24px"},attrs:{slot:"indicator",type:"loading",spin:""},slot:"indicator"})],1),t._v(" "),e("span",[t._v("Fetching info from market. Please wait.")])],1)])]):t._e()],1)}),[function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("thead",[e("tr",[e("th",{attrs:{colspan:"2"}},[t._v("You have unsettled balances:")])])])}],!1,null,null,null);n.default=component.exports;installComponents(component,{CoinSelect:e(407).default,AmmIdSelect:e(401).default,UnofficialPoolConfirmUser:e(409).default,InputAmmIdOrMarket:e(408).default,CoinInput:e(406).default})}}]);